<div class="summary-vintages">
    <form class="form-horizontal" name="form" ng-submit="withdraw()" role="form" novalidate>
        <div class="row header">
            <div class="col-xs-12">
                <div ng-if="!canWithdraw" class="col-xs-6 text-left">Vintage</div>
                <div ng-if="!canWithdraw" class="col-xs-6 text-right">Invested</div>
                <div ng-if="canWithdraw" class="col-xs-2 text-left">Vintage</div>
                <div ng-if="canWithdraw" class="col-xs-4 text-right">You have invested</div>
                <div ng-if="canWithdraw" class="col-xs-4 text-right">You will receive</div>
                <div ng-if="canWithdraw" class="col-xs-2 text-center">Withdraw</div>
            </div>
        </div>

        <div class="row group" ng-repeat="group in vintagesPerYear" ng-class="{'expanded':!group.isCollapsed}" ng-init="group.isCollapsed = $index > 0;group.hide = $index > 0;">
            <div class="col-xs-12 text-left year">
                <span>{{group.$key}}</span>
                <i class="fa fa-chevron-circle-right" ng-class="{'fa-rotate-90':!group.isCollapsed}" ng-click="toggleExpandCollapse(group)"></i>
            </div>
            <div class="col-xs-12 months" ng-style="{
                'height': group.isCollapsed ? 0 : group.length * 20,
                'display': group.hide ? 'none' : 'block'
            }">
                <div class="month" ng-repeat="vintage in group"
                     ng-class="{'sold': vintage.Sold,'selected': vintage.SellThisMonth && !vintage.Sold}">
                    <div ng-if="!canWithdraw" class="col-xs-6 text-left">{{vintage.Date | date : 'MMMM'}}</div>
                    <div ng-if="!canWithdraw" class="col-xs-6 text-right">{{vintage.InvestAmount | currency : currency : 0}}</div>
                    <div ng-if="canWithdraw" class="col-xs-2 text-left">{{vintage.Date | date : 'MMMM'}}</div>
                    <div ng-if="canWithdraw" class="col-xs-4 text-right">{{vintage.InvestAmount | currency : currency : 0}}</div>
                    <div ng-if="canWithdraw" class="col-xs-4 text-right">{{vintage.SellingValue | currency : currency : 0}}</div>
                    <div ng-if="canWithdraw" class="col-xs-2 text-right">
                        <gz-check-box gz-model="vintage" gz-value="SellThisMonth" gz-disabled="vintage.Sold"></gz-check-box>
                    </div>
                </div>
            </div>
        </div>
        
        <div ng-if="canWithdraw" class="row">
            <div class="col-xs-6 text-left total">Total gain</div>
            <div class="col-xs-6 text-right total amount">{{totalGain() | currency : currency : 0}}</div>
        </div>

        <div ng-if="canWithdraw" class="row">
            <div class="col-xs-12 text-center">
                <button type="submit" class="btn-gz" ng-disabled="thereIsNoSelectedVintage()">Withdraw</button>
            </div>
        </div>
    </form>
</div>